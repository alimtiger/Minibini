{% extends 'base.html' %}

{% block title %}Task Mappings - Minibini{% endblock %}

{% block navigation %}
{% include 'includes/settings_navigation.html' %}
{% endblock %}

{% block content %}
<h2>Task Mappings</h2>
<p>Transformation rules that define how tasks map to estimate line items.</p>

{% if mappings %}
    <table border="1">
        <tr>
            <th>Task Type</th>
            <th>Step Type</th>
            <th>Mapping Strategy</th>
            <th>Default Product Type</th>
            <th>Line Item Name</th>
            <th>Line Item Description</th>
            <th>Breakdown of Task</th>
        </tr>
        {% for mapping in mappings %}
        <tr>
            <td>{{ mapping.task_type_id }}</td>
            <td>{{ mapping.get_step_type_display }}</td>
            <td>{{ mapping.get_mapping_strategy_display }}</td>
            <td>{{ mapping.default_product_type|default:"-" }}</td>
            <td>{{ mapping.line_item_name|default:"-" }}</td>
            <td>{{ mapping.line_item_description|truncatewords:15|default:"-" }}</td>
            <td>{{ mapping.breakdown_of_task|truncatewords:15|default:"-" }}</td>
        </tr>
        {% endfor %}
    </table>
{% else %}
    <p>No task mappings found.</p>
{% endif %}

<h3>Mapping Strategy Reference</h3>
<p>Available mapping strategies that define how tasks are converted to estimate line items:</p>
<ul>
    <li><strong>Direct</strong> - One task to one line item (e.g., consultation becomes "Design Consultation")</li>
    <li><strong>Bundle into product line item</strong> - Multiple tasks bundled into one product (e.g., cut + assemble + finish → "Custom Table")</li>
    <li><strong>Bundle into service line item</strong> - Multiple tasks bundled into one service (e.g., delivery tasks → "Delivery & Installation")</li>
    <li><strong>Internal only - exclude from estimate</strong> - Internal tasks not shown to customer (e.g., quality assurance)</li>
</ul>

{% endblock %}