{% extends 'base.html' %}

{% block title %}Add Task Template - Minibini{% endblock %}

{% block content %}
<h2>Add Task Template to "{{ work_order_template.template_name }}"</h2>

{% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

<form method="post">
    {% csrf_token %}
    <table>
        {{ form.as_table }}
    </table>
    <br>
    <button type="submit" name="add">Add Task Template</button>
    <button type="submit" name="add_another">Add and Create Another</button>
    <a href="{% url 'jobs:work_order_template_detail' work_order_template.template_id %}">Cancel</a>
</form>

{% if existing_tasks %}
<h3>Existing Task Templates</h3>
<table border="1">
    <tr>
        <th>Task Name</th>
        <th>Units</th>
        <th>Rate</th>
        <th>Est. Quantity</th>
        <th>Active</th>
    </tr>
    {% for task in existing_tasks %}
    <tr>
        <td>{{ task.template_name }}</td>
        <td>{{ task.units|default:"-" }}</td>
        <td>{{ task.rate|default:"-" }}</td>
        <td>{{ task.est_qty|default:"-" }}</td>
        <td>{{ task.is_active|yesno:"Yes,No" }}</td>
    </tr>
    {% endfor %}
</table>
{% endif %}

{% endblock %}