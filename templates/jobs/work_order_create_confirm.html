{% extends 'base.html' %}

{% block title %}Create Work Order from Estimate - Minibini{% endblock %}

{% block content %}
<h2>Create Work Order from Estimate</h2>

<p>You are about to create a Work Order from the following estimate:</p>

<table border="1">
    <tr>
        <th>Estimate Number</th>
        <td>{{ estimate.estimate_number }}</td>
    </tr>
    <tr>
        <th>Job</th>
        <td>{{ estimate.job.job_number }} - {{ estimate.job.description|default:"No description" }}</td>
    </tr>
    <tr>
        <th>Estimate Status</th>
        <td>{{ estimate.get_status_display }}</td>
    </tr>
    <tr>
        <th>Version</th>
        <td>{{ estimate.version }}</td>
    </tr>
</table>

{% if worksheet %}
<h3>Source Worksheet Information</h3>
<p>The following data will be copied from the associated worksheet:</p>
<ul>
    <li>Template: {{ worksheet.template.template_name|default:"No template" }}</li>
    <li>Number of tasks to copy: {{ task_count }}</li>
</ul>
{% else %}
<p><strong>Note:</strong> No worksheet is associated with this estimate. The Work Order will be created without tasks.</p>
{% endif %}

<h3>Work Order Details</h3>
<p>The new Work Order will be created with:</p>
<ul>
    <li>Status: Draft</li>
    <li>Job: {{ estimate.job.job_number }}</li>
    {% if worksheet %}
    <li>All tasks from the worksheet (with preserved hierarchy and mapping data)</li>
    {% else %}
    <li>No tasks (can be added manually later)</li>
    {% endif %}
</ul>

<form method="post" style="margin-top: 20px;">
    {% csrf_token %}
    <button type="submit" class="btn-primary">Create Work Order</button>
    <a href="{% url 'jobs:estimate_detail' estimate.estimate_id %}" class="btn-secondary">Cancel</a>
</form>

{% endblock %}